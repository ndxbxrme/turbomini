<!doctype html>
<html>
  <body>
    <button id="login">Toggle Login</button>
    <nav>
      <a id="admin-link" href="/admin">Admin</a>
    </nav>
    <page></page>
    <script type="module">
      import { TurboMini } from '../../src/turbomini.js';
      const app = TurboMini('/examples/07-middleware-guard');
      app.template('default', '<h1 id="status">{{loggedIn ? "Logged In" : "Logged Out"}}</h1>');
      app.template('admin', '<h1 id="admin">Admin</h1>');
      const store = { loggedIn: false };
      app.controller('default', () => store);
      app.controller('admin', () => store);
      app.addMiddleware(ctx => {
        if (ctx.page === 'admin' && !store.loggedIn) return false;
      });
      document.getElementById('login').addEventListener('click', () => {
        store.loggedIn = !store.loggedIn;
        app.invalidate();
      });
      app.start();
      window.app = app;
    </script>
  </body>
</html>
